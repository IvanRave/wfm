var BlobBuilder=BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder||function(n){"use strict";var h=function(n){return Object.prototype.toString.call(n).match(/^\[object\s(.*)\]$/)[1]},u=function(){this.data=[]},i=function(n,t,i){this.data=n,this.size=n.length,this.type=t,this.encoding=i},f=u.prototype,e=i.prototype,c=n.FileReaderSync,l=function(n){this.code=this[this.name=n]},a="NOT_FOUND_ERR SECURITY_ERR ABORT_ERR NOT_READABLE_ERR ENCODING_ERR NO_MODIFICATION_ALLOWED_ERR INVALID_STATE_ERR SYNTAX_ERR".split(" "),o=a.length,t=n.URL||n.webkitURL||n,v=t.createObjectURL,y=t.revokeObjectURL,s=t,p=n.btoa,w=n.atob,b=!1,k=function(n){b=!n},d=n.ArrayBuffer,r=n.Uint8Array;for(u.fake=e.fake=!0;o--;)l.prototype[a[o]]=o+1;try{r&&k.apply(0,new r(1))}catch(g){}return t.createObjectURL||(s=n.URL={}),s.createObjectURL=function(n){var u=n.type,r;return(u===null&&(u="application/octet-stream"),n instanceof i)?(r="data:"+u,n.encoding==="base64")?r+";base64,"+n.data:n.encoding==="URI"?r+","+decodeURIComponent(n.data):p?r+";base64,"+p(n.data):r+","+encodeURIComponent(n.data):v?v.call(t,n):void 0},s.revokeObjectURL=function(n){n.substring(0,5)!=="data:"&&y&&y.call(t,n)},f.append=function(n){var t=this.data,e;if(r&&n instanceof d)if(b)t.push(String.fromCharCode.apply(String,new r(n)));else for(var o="",f=new r(n),u=0,s=f.length;u<s;u++)o+=String.fromCharCode(f[u]);else if(h(n)==="Blob"||h(n)==="File")if(c)e=new c,t.push(e.readAsBinaryString(n));else throw new l("NOT_READABLE_ERR");else n instanceof i?n.encoding==="base64"&&w?t.push(w(n.data)):n.encoding==="URI"?t.push(decodeURIComponent(n.data)):n.encoding==="raw"&&t.push(n.data):(typeof n!="string"&&(n+=""),t.push(unescape(encodeURIComponent(n))))},f.getBlob=function(n){return arguments.length||(n=null),new i(this.data.join(""),n,"raw")},f.toString=function(){return"[object BlobBuilder]"},e.slice=function(n,t,r){var u=arguments.length;return u<3&&(r=null),new i(this.data.slice(n,u>1?t:this.data.length),r,this.encoding)},e.toString=function(){return"[object Blob]"},u}(self);